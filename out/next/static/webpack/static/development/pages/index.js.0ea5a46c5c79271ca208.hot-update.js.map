{"version":3,"file":"static/webpack/static/development/pages/index.js.0ea5a46c5c79271ca208.hot-update.js","sources":["webpack:///./pages/index.js"],"sourcesContent":["import {Box, Avatar, Text, Divider, IconButton, Column, Button, Spinner} from \"gestalt\";\nimport {TiHomeOutline, TiChartAreaOutline, TiCalendarOutline, TiTags, TiShoppingCart} from \"react-icons/ti\";\nimport {PullToRefresh} from 'react-js-pull-to-refresh';\nimport Home from '../components/home';\nimport Ranking from '../components/ranking';\nimport Event from '../components/event';\nimport Mission from '../components/mission';\nimport Shopping from '../components/shopping';\nimport Profile from '../components/profile';\nimport Info from '../components/info';\nimport Login from '../components/login';\nimport Game from '../components/game';\nimport 'gestalt/dist/gestalt.css';\nimport './index.css';\n\nclass Main extends React.Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      page: \"main\",\n      route: \"home\",\n      id: \"\",\n      data: [],\n      name: \"\",\n      family: \"Book Family\",\n      rank: \"\",\n      score: 0,\n      avatar: \"\",\n      cover: \"\",\n      allPackages: [],\n      familyPackages: [],\n      childrenPackages: [],\n      competitionPackages: [],\n      entertainmentPackages: [],\n      events: [],\n      buy: {\"1\": true},\n      show: true,\n      choosePackage: null,\n      mission: []\n    }\n  }\n\n  componentDidMount() {\n    this.verify()\n  }\n\n  buyPackage(index) {\n    this.setState(prevState => { prevState[\"\" + index + \"\"] = true; return { buy: prevState }})\n  }\n\n  choosePackage(index) {\n    this.setState({choosePackage: index})\n  }\n\n  verify() {\n    let token = localStorage.getItem('token');\n      if(token) {\n        fetch('https://savacloud.herokuapp.com/verify', {\n            method: \"GET\",\n            headers: {\n                'Accept': 'application/json, text/plain, */*',\n                'Content-Type': 'application/json',\n                'Authorization': token\n            }\n        })\n        .then(result => {\n            if (result.status === 200) return result.json()\n            else throw Error(\"lỗi đăng nhập\")\n        })\n        .then(result => {\n            if (result.error) throw Error(\"lỗi token\")\n            this.fetchData()\n        })\n        .catch(e => {\n            localStorage.removeItem('token')\n            this.setState({page: 'login'})\n        })\n      } else this.setState({page: 'login'})\n  }\n\n  fetchData() {\n    let decode = atob(window.localStorage.getItem('token').split('.')[1]);\n    let info = JSON.parse(decode);\n    this.setState({\n      id: info.userId,\n      data: [{\n          label: \"Khả năng\",\n          backgroundColor: \"rgb(145, 229, 246, 0.5)\",\n          borderColor: 'rgb(54, 162, 235)',\n          data: [info.info.math, info.info.physic, info.info.chemistry, info.info.literature, info.info.history, info.info.geography, info.info.skill, info.info.linked],\n          fill: 'origin'\n      }],\n      name: decodeURIComponent(escape(info.info.name)),\n      family: \"Book Family\",\n      rank: \"\",\n      score: info.info.scores,\n      avatar: info.info.avatar,\n      cover: info.info.cover\n    })\n\n    Promise.all([\n      fetch('https://script.google.com/macros/s/AKfycbxXAz_BiTl-g4fVcN_5_HwouklaD1XMrF1CXMYWO4dp0VgHi10/exec')\n          .then(result => \n              result.json()\n          )\n          .then(result => {\n              this.setState({ads : result.result});\n          }),\n      fetch('https://script.google.com/macros/s/AKfycbxhPOYd6asdd_w9c6iB3CCdzsg4VYzFh7qKgZiNi-IKlcOo665O/exec')\n          .then(result =>\n              result.json()\n          )\n          .then(result => {\n              this.setState({events : result.result});\n          }),\n      fetch('https://script.google.com/macros/s/AKfycbwgXrL-ZO5fryEonD6VWLJhsaxZg2VtaH-A9rLIoNZLLkQWTfM/exec')\n          .then(result => \n              result.json()\n          )\n          .then(result => {\n              this.setState({allPackages : result.result, familyPackages:[], childrenPackages: [], competitionPackages: [], entertainmentPackages: []});\n              result.result.map((ele, index) => {\n                  switch(ele.packageType) {\n                      case 'FAMILY': this.setState({familyPackages : [...this.state.familyPackages, index]}); break;\n                      case 'CHILDREN': this.setState({childrenPackages : [...this.state.childrenPackages, index]}); break;\n                      case 'COMPETITION': this.setState({competitionPackages : [...this.state.competitionPackages,index]}); break;\n                      case 'ENTERTAINMENT': this.setState({entertainmentPackages : [...this.state.entertainmentPackages, index]}); break;\n                  }\n              })\n          })\n    ]).then (result => {\n      this.setState({show: false}) \n    })\n  }\n\n  changeRoute(route) {\n    this.setState({\n      route: route\n    })\n  }\n\n  changePage(route) {\n    this.setState({\n      page: route,\n      route: 'home'\n    })\n    if(route === \"main\") this.verify()\n  }\n\n  refresh() {\n    this.setState({\n      show: true\n    })\n    this.verify()\n  }\n\n  render() {\n    if(this.state.page === 'login') return (<Login changeRoute={route => this.changePage(route)}/>)\n    else if(this.state.page === 'game') return (<Game changeRoute={route => this.changePage(route)}/>)\n    else if(this.state.page === 'register') return (<Game changeRoute={route => this.changePage(route)}/>)\n    else if(this.state.page === 'fogot') return (<Game changeRoute={route => this.changePage(route)}/>)\n    else return(\n      <PullToRefresh onRefresh={this.refresh} pullDownThreshold={200}>\n      <Box height=\"100vh\" width=\"100%\">\n       \n          {\n            (this.state.route === \"info\") ?\n          <Box\n            alignItems=\"center\"\n            direction=\"row\"\n            display=\"flex\"\n            width=\"100%\"\n            height=\"4rem\"\n            paddingY={2}\n            color=\"white\"\n          > \n            <Column span={3}>\n              <Box paddingX={2} >\n                <IconButton icon=\"arrow-back\" onClick={e => {this.changeRoute('home')}} accessibilityLabel=\"back\"/>\n              </Box>\n            </Column>\n            <Column span={5}>\n            </Column>\n            <Column span={4}>\n              <Box paddingX={2} >\n                  <Button text=\"Tham gia\" color=\"blue\" onClick={e => {this.changePage('game')}}/>\n              </Box>\n            </Column>\n          </Box>\n          :\n          (this.state.route === \"profile\") ?\n          <Box\n          alignItems=\"center\"\n          direction=\"row\"\n          display=\"flex\"\n          width=\"100%\"\n          height=\"4rem\"\n          paddingY={2}\n          color=\"white\"\n        > \n          <Column span={3}>\n            <Box paddingX={2} >\n              <IconButton icon=\"arrow-back\" onClick={e => {this.changeRoute('home')}} accessibilityLabel=\"back\"/>\n            </Box>\n          </Column>\n          <Column span={4}>\n          </Column>\n          <Column span={5}>\n            <Box paddingX={2} >\n                <Button text=\"Đăng xuất\" color=\"red\" onClick={e => {localStorage.removeItem('token'), this.changePage('login')}}/>\n            </Box>\n          </Column>\n        </Box>\n        :  (this.state.route === \"infoshop\") ?\n        <Box\n          alignItems=\"center\"\n          direction=\"row\"\n          display=\"flex\"\n          width=\"100%\"\n          height=\"4rem\"\n          paddingY={2}\n          color=\"white\"\n        > \n          <Column span={3}>\n            <Box paddingX={2} >\n              <IconButton icon=\"arrow-back\" onClick={e => {this.changeRoute('shopping')}} accessibilityLabel=\"back\"/>\n            </Box>\n          </Column>\n          <Column span={4}>\n          </Column>\n          <Column span={5}>\n            <Box paddingX={2} >\n              <Button text={this.state.buy[\"\" + this.state.choosePackage + \"\"] ? \"Đã mua\" : \"Mua ngay\"}  onClick={e => this.buyPackage(this.state.choosePackage)} color={this.state.buy[\"\" + this.state.choosePackage + \"\"] ? \"blue\" : \"gray\"}></Button>\n            </Box>\n          </Column>\n        </Box> :\n            <Box\n              alignItems=\"center\"\n              direction=\"row\"\n              display=\"flex\"\n              width=\"100%\"\n              height=\"3rem\"\n              paddingY={2}\n              color=\"white\"\n            >\n              <Box paddingX={2} width=\"4\">\n                <div onClick={e => this.changeRoute('profile')}>\n                  <Avatar name={this.state.name} size='sm' src={this.state.avatar}/>\n                </div>\n              </Box>\n              <Box>\n                <Text> xin chào </Text>\n              </Box>\n              <Box paddingX={1}>\n                <Text weight=\"bold\"> {this.state.name} </Text>\n              </Box> \n            </Box> \n          }\n        \n        <Divider />\n        <Divider />\n\n        <Box margin={2} display={this.state.show ? \"block\" : \"none\"}>\n          <Spinner accessibilityLabel=\"data spinner\" show={this.state.show}/>\n        </Box>\n\n        <Box height={this.state.route === \"profile\" || this.state.route === \"info\" || this.state.route === \"infoshop\" ? \"calc(100vh - 4rem - 3.8rem)\" : \"calc(100vh - 3rem - 3.8rem)\"} width=\"100%\" overflow=\"scrollY\">\n          {\n            this.state.route === \"home\" ? \n              <Home onGoShopping={() => this.changeRoute('shopping')} onGoInfo={(index) => {this.changeRoute('info'); this.choosePackage(index)}} {...this.state}/> : \n              this.state.route === \"ranking\" ? \n                <Ranking {...this.state}/> :\n                this.state.route === \"event\" ?\n                  <Event {...this.state}/>:\n                  this.state.route === \"mission\" ?\n                    <Mission {...this.state}/> : \n                    this.state.route === \"shopping\" ?\n                      <Shopping {...this.state} buyPackage={value => this.buyPackage(value)} onGoInfo={(index) => {this.changeRoute('infoshop'); this.choosePackage(index)}}/> : \n                      this.state.route === \"profile\" ?\n                        <Profile {...this.state}/> : <Info {...this.state}/>\n          }\n        </Box>\n\n        <Divider />\n        <Divider />\n        <Box \n          position=\"fixed\"\n          bottom\n          left\n          direction = \"row\"\n          display = \"flex\"\n          width = \"100%\"\n          height = \"3.6rem\"\n          color = \"white\"\n        >\n            <Box justifyContent=\"center\" width=\"20%\" display=\"flex\" alignItems=\"center\"> \n              <TiHomeOutline size=\"27\" color={this.state.route === \"home\" ? \"#59a5d8\" : \"#8e8e8e\"} onClick={e => this.changeRoute('home')}/> \n            </Box>\n            <Box justifyContent=\"center\" width=\"20%\" display=\"flex\" alignItems=\"center\"> \n              <TiChartAreaOutline size=\"27\" color={this.state.route === \"ranking\" ? \"#59a5d8\" : \"#8e8e8e\"} onClick={e => this.changeRoute('ranking')}/> \n            </Box>\n            <Box justifyContent=\"center\" width=\"20%\" display=\"flex\" alignItems=\"center\"> \n              <TiCalendarOutline size=\"27\" color={this.state.route === \"event\" ? \"#59a5d8\" : \"#8e8e8e\"} onClick={e => this.changeRoute('event')}/> \n            </Box>\n            <Box justifyContent=\"center\" width=\"20%\" display=\"flex\" alignItems=\"center\"> \n              <TiTags size=\"27\" color={this.state.route === \"mission\" ? \"#59a5d8\" : \"#8e8e8e\"} onClick={e => this.changeRoute('mission')}/> \n            </Box>\n            <Box justifyContent=\"center\" width=\"20%\" display=\"flex\" alignItems=\"center\"> \n              <TiShoppingCart size=\"27\" color={this.state.route === \"shopping\" ? \"#59a5d8\" : \"#8e8e8e\"} onClick={e => this.changeRoute('shopping')}/> \n            </Box>\n        </Box>\n      </Box>\n      </PullToRefresh>\n    )\n  }\n}\n\nexport default Main;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AApBA;AAFA;AAwBA;AACA;;;AACA;AACA;AACA;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;AAEA;AACA;AAAA;AAAA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAFA;AASA;AAEA;AAEA;AACA;AAAA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AACA;AACA;AAdA;AACA;AAgBA;AAEA;AAAA;AAIA;AAAA;AAAA;AACA;AAEA;AAAA;AAIA;AAAA;AAAA;AACA;AAEA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAJA;AAMA;AACA;AAEA;AAAA;AAAA;AACA;AACA;;;AAEA;AACA;AACA;AADA;AAGA;;;AAEA;AACA;AACA;AACA;AAFA;AAIA;AACA;;;AAEA;AACA;AACA;AADA;AAGA;AACA;;;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;;;;AA3SA;AACA;AA6SA;;;;A","sourceRoot":""}